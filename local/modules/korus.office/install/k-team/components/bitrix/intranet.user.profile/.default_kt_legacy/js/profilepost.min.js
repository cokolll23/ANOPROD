!function(){var t=BX.namespace("BX.Intranet.UserProfile");t.ProfilePost||(t.ProfilePost=function(t){this.init(t)},t.ProfilePost.prototype={init:function(t){this.managerInstance=t.managerInstance,this.options=t.options,this.loaderNode=BX("intranet-user-profile-about-loader"),this.wrapperNode=BX("intranet-user-profile-about-wrapper"),this.containerNode=BX("intranet-user-profile-post-container"),this.editLinkNode=BX("intranet-user-profile-post-edit-link"),this.stubButtonNode=BX("intranet-user-profile-post-edit-stub-button"),this.loader=null,this.LHEEventNode=BX("div"+this.options.profilePostData.lheId),this.getData(),this.managerInstance.processSliderCloseEvent({entityType:"profilePost",callback:function(){BX.cleanNode(this.wrapperNode),this.getData()}.bind(this)}),this.editLinkNode&&BX.bind(this.editLinkNode,"click",function(){this.getFormData()}.bind(this)),this.stubButtonNode&&BX.bind(this.stubButtonNode,"click",function(){this.getFormData()}.bind(this)),this.LHEEventNode&&(BX.addCustomEvent(this.LHEEventNode,"OnProfilePostFormAfterShow",function(t,e){this.OnProfilePostFormAfterShow(t,e)}.bind(this)),BX.addCustomEvent(this.LHEEventNode,"OnClickSubmit",function(t){this.OnClickSubmit(t)}.bind(this)),BX.addCustomEvent(this.LHEEventNode,"OnClickCancel",function(t){this.setContainerEditMode(!1),this.showPostContainer(!0)}.bind(this)))},getData:function(){BX.addClass(this.loaderNode,"intranet-user-profile-loader-getdata"),this.loader=this.managerInstance.showLoader({node:this.loaderNode,loader:this.loader}),BX.ajax.runComponentAction(this.managerInstance.componentName,"getProfileBlogPost",{mode:"class",signedParameters:this.managerInstance.signedParameters,data:{}}).then(function(t){this.managerInstance.hideLoader({node:this.loaderNode,loader:this.loader}),BX.removeClass(this.loaderNode,"intranet-user-profile-loader-getdata"),this.setContainerEmpty(!BX.type.isNotEmptyObject(t.data)),BX.type.isNotEmptyObject(t.data)&&this.showData(t.data)}.bind(this),function(t){this.managerInstance.hideLoader({node:this.loaderNode,loader:this.loader}),BX.removeClass(this.loaderNode,"intranet-user-profile-loader-getdata")}.bind(this))},setContainerEmpty:function(t){this.containerNode&&(t?BX.addClass(this.containerNode,"intranet-user-profile-container-empty"):BX.removeClass(this.containerNode,"intranet-user-profile-container-empty"))},setContainerEditMode:function(t){this.containerNode&&(t?BX.addClass(this.containerNode,"intranet-user-profile-container-editmode"):BX.removeClass(this.containerNode,"intranet-user-profile-container-editmode"))},showData:function(t){var e,o;this.wrapperNode&&(this.showPostContainer(!0),BX.type.isNotEmptyObject(t))&&BX.type.isNotEmptyObject(t.additionalParams)&&BX.type.isNotEmptyObject(t.additionalParams.POST)&&(e=t.additionalParams.POST,BX.type.isNotEmptyString(e.TITLE)&&this.wrapperNode.appendChild(BX.create("DIV",{props:{className:"intranet-user-profile-container-body-title"},html:e.TITLE})),BX.type.isNotEmptyString(t.html)&&(o=BX.create("DIV",{props:{className:"intranet-user-profile-about"}}),this.wrapperNode.appendChild(o),BX.html(o,t.html)),BX.type.isNotEmptyObject(e.UF_RENDERED))&&BX.Intranet.UserProfile.Utils.processAjaxBlock({data:e.UF_RENDERED,className:"intranet-user-profile-about-props",containerNode:this.wrapperNode})},getFormData:function(){this.showPostContainer(!1),this.setContainerEditMode(!0),this.managerInstance.showLoader({node:this.loaderNode,loader:this.loader}),BX.ajax.runComponentAction(this.managerInstance.componentName,"getProfileBlogPostForm",{mode:"class",signedParameters:this.managerInstance.signedParameters,data:{}}).then(function(t){this.managerInstance.hideLoader({node:this.loaderNode,loader:this.loader}),this.showFormData(t.data)}.bind(this),function(t){this.managerInstance.hideLoader({node:this.loaderNode,loader:this.loader}),this.showPostContainer(!0)}.bind(this))},showPostContainer:function(t){this.wrapperNode&&(this.wrapperNode.style.display=t?"block":"none")},showFormData:function(t){this.LHEEventNode&&(BX.onCustomEvent(this.LHEEventNode,"OnShowLHE",["show"]),BX.onCustomEvent(this.LHEEventNode,"OnProfilePostFormAfterShow",[t]))},OnProfilePostFormAfterShow:function(t){t=t||{};var e=BX.type.isNotEmptyString(t.DETAIL_TEXT)?t.DETAIL_TEXT:"",o={};BX.type.isNotEmptyObject(t.UF)&&BX.type.isNotEmptyObject(t.UF.UF_BLOG_POST_FILE)&&(o.UF_BLOG_POST_FILE={USER_TYPE_ID:"disk_file",FIELD_NAME:"UF_BLOG_POST_FILE[]",VALUE:BX.clone(t.UF.UF_BLOG_POST_FILE.VALUE)}),LHEPostForm.reinitData(this.options.profilePostData.lheId,e,o)},OnClickSubmit:function(t){var e=t.oEditor.GetContent(),t=t.formID,o=BX.type.isNotEmptyString(t)?BX(t):null,t=BX.type.isNotEmptyString(t)?BX("lhe_button_submit_"+t):null;o&&(o=BX.ajax.prepareForm(o),this.sendFormData({text:e,submitButton:t,additionalData:o.data}))},sendFormData:function(e){this.showButtonWait(e.submitButton,!0),BX.type.isNotEmptyString(e.text)?BX.ajax.runComponentAction(this.managerInstance.componentName,"sendProfileBlogPostForm",{mode:"class",signedParameters:this.managerInstance.signedParameters,data:{params:{text:e.text,additionalData:e.additionalData}}}).then(function(t){this.showButtonWait(e.submitButton,!1),BX.onCustomEvent(this.LHEEventNode,"OnShowLHE",["hide"]),BX.cleanNode(this.wrapperNode),this.getData(),this.setContainerEditMode(!1)}.bind(this),function(t){this.setContainerEditMode(!1),this.showButtonWait(e.submitButton,!1)}.bind(this)):BX.ajax.runComponentAction(this.managerInstance.componentName,"deleteProfileBlogPost",{mode:"class",signedParameters:this.managerInstance.signedParameters,data:{params:{}}}).then(function(t){this.showButtonWait(e.submitButton,!1),BX.onCustomEvent(this.LHEEventNode,"OnShowLHE",["hide"]),BX.cleanNode(this.wrapperNode),this.getData(),this.setContainerEditMode(!1)}.bind(this),function(t){this.setContainerEditMode(!1),this.showButtonWait(e.submitButton,!1)}.bind(this))},showButtonWait:function(t,e){t&&(e?BX.addClass(t,"ui-btn-clock"):BX.removeClass(t,"ui-btn-clock"))}})}();