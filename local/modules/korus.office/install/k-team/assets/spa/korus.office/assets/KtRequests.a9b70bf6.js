import{Q as z,a as g,b as B,c as d}from"./QTable.d6d4404d.js";import{L as R,dS as O,N as h,aL as D,o as F,I as N,x as o,y as u,z as s,S as m,e as a,V as t,i as Q,R as w,F as y,U as x,c as U,av as j,ad as A,$ as K}from"./index.a1748043.js";import{u as H}from"./vue-i18n.esm-bundler.e5a16dbd.js";import{u as I}from"./useTabs.f0639b31.js";import{u as M}from"./usePagination.17cd9769.js";import{_ as W,B as X,C as G,D as J,c as q,w as Y,h as Z,E as ee,F as te}from"./KtViewCounter.d7f8eb76.js";import{_ as ae,K as se}from"./KtWidgetWrapper.6a945d5d.js";import"./QSkeleton.d8507126.js";import le from"./KtRequestProcess.1173f4ba.js";import"./KtRequestProcessIndicator.452c47ae.js";import"./QList.41df81dd.js";import"./QSelect.1740ff4d.js";import"./QChip.2708c0c7.js";import"./QItemLabel.b302d2e1.js";import"./QMenu.8a4718ad.js";import"./rtl.276c3f1b.js";import"./QTabs.a9c1b64a.js";import"./QResizeObserver.988c698f.js";import"./_commonjsHelpers.2cf1d77b.js";import"./QBadge.cb8db555.js";import"./index.2f026771.js";import"./QBtnDropdown.41a9457c.js";import"./QDate.59abae0b.js";import"./use-render-cache.3aae9b27.js";import"./ClosePopup.034ffd88.js";import"./QScrollArea.ec251a08.js";import"./QScrollObserver.bf79761e.js";import"./touch.9135741d.js";import"./QExpansionItem.ec578cd9.js";import"./QImg.7d3e6d1d.js";import"./IndexPage.75cfb3f1.js";import"./QPagination.de182206.js";import"./QTabPanels.aa3c86a4.js";import"./index.43b0bc22.js";import"./useAvatarUploader.88af71b4.js";import"./grid.65269509.js";import"./plugin-vue_export-helper.21dcd24c.js";const ie={class:"kt-requests"},oe={class:"kt-requests__header"},ne={class:"kt-requests__content"},re={class:"kt-requests__top"},de=".js-requests-table",ue=".js-requests-table-scroll",me=10,Ye=R({__name:"KtRequests",setup(ce){const c=O(),{t:n}=H(),{activeTab:p}=I(),{isFirstPage:k,isLastPage:v,totalPages:S,hasPagination:_,perPageOptions:$,prevPage:pe,nextPage:fe}=M(c),{tabs:P,list:T,nav:r}=h(c),{currentUser:L}=h(D()),C=[{name:"id",label:n("requests.table.id"),align:"left",field:"id",style:"min-width: 50px"},{name:"title",label:n("requests.table.title"),align:"left",field:"title",style:"min-width: 280px"},{name:"process",label:n("requests.table.process"),align:"left",field:"indicator",style:"min-width: 200px"},{name:"status",label:n("requests.table.status"),align:"left",field:"status",style:"min-width: 130px"},{name:"maxDeadline",label:n("requests.table.deadline"),align:"left",field:"maxDeadline",style:"min-width: 150px"}],E=window.BX;F(b);function b(){const i=document.querySelector(de),l=document.querySelector(ue);if(i===null||l===null)return!1;l.style.height=i.offsetHeight+me+"px"}function V(i){E.SidePanel.Instance.open("/lk/request/detail.php?id="+i,{width:1e3,allowChangeHistory:!1,cacheable:!1,mobileFriendly:!0,events:{onLoad:function(){document.body.style.overflow="hidden"},onClose:function(){document.body.style.overflow="inherit"}}})}return c.$onAction(({after:i,name:l})=>{if(l!=="load")return!1;i(async()=>{await N(),b()})}),(i,l)=>(o(),u(t(se),null,{default:s(()=>[m("div",ie,[m("header",oe,[a(t(ae),{text:i.$t("requests.title")},null,8,["text"]),a(t(W),{theme:"primary",href:"/lk/service/#/",label:i.$t("common.btn.add"),"icon-right":"add"},null,8,["label"])]),m("div",ne,[m("div",re,[a(t(X),{modelValue:t(p),"onUpdate:modelValue":l[0]||(l[0]=e=>Q(p)?p.value=e:null),"mobile-arrows":"",shrink:"",align:"left","no-caps":""},{default:s(()=>[(o(!0),w(y,null,x(t(P),e=>(o(),u(t(G),{key:e.name,name:e.name,label:e.label},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),a(t(J),{visible:"",class:"kt-requests__scroll js-requests-table-scroll"},{default:s(()=>[a(z,{rows:t(T),columns:C,pagination:{rowsPerPage:U(()=>t(r).pageSize)},"row-key":"name","wrap-cells":"",separator:"horizontal",class:"js-requests-table","hide-bottom":"",flat:"","no-data-label":i.$t("requests.table.noData")},{header:s(e=>[a(g,{props:e},{default:s(()=>[(o(!0),w(y,null,x(e.cols,f=>(o(),u(B,{key:f.name,props:e},{default:s(()=>[j(A(f.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:s(e=>[a(g,{props:e},{default:s(()=>[a(d,{key:"id",props:e},{default:s(()=>[a(t(q),{content:e.row.id,lines:1},null,8,["content"])]),_:2},1032,["props"]),a(d,{key:"title",props:e},{default:s(()=>[a(t(Y),{theme:"secondary",onClick:f=>V(e.row.id),class:"cursor-pointer"},{default:s(()=>[a(t(q),{content:e.row.title,lines:2},null,8,["content"])]),_:2},1032,["onClick"])]),_:2},1032,["props"]),a(d,{key:"process",props:e},{default:s(()=>[a(t(le),{author:t(L),executors:e.row.response,"status-id":e.row.status.id,"indicator-text":e.row.indicator,"message-count":e.row.countMessage},null,8,["author","executors","status-id","indicator-text","message-count"])]),_:2},1032,["props"]),a(d,{key:"status",props:e},{default:s(()=>[a(t(Z),{theme:e.row.status.theme,text:e.row.status.text,inline:""},null,8,["theme","text"])]),_:2},1032,["props"]),a(d,{key:"maxDeadline",props:e},{default:s(()=>[a(t(ee),{date:e.row.maxDeadlineFormatted,isOverdue:e.row.isOverdue},null,8,["date","isOverdue"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","pagination","no-data-label"])]),_:1}),t(_)?(o(),u(t(te),{key:0,modelValue:t(r).currentPage,"onUpdate:modelValue":l[1]||(l[1]=e=>t(r).currentPage=e),"page-size":t(r).pageSize,"onUpdate:pageSize":l[2]||(l[2]=e=>t(r).pageSize=e),"page-size-options":t($),"has-pagination":t(_),maxPage:t(S),"is-prev-disabled":t(k),"is-next-disabled":t(v),class:"q-mt-md"},null,8,["modelValue","page-size","page-size-options","has-pagination","maxPage","is-prev-disabled","is-next-disabled"])):K("",!0)])])]),_:1}))}});export{Ye as default};
