import{g as ie,c as q,j as ne,K as R,_ as V}from"./KtViewCounter.d7f8eb76.js";import J from"./KtGratitude.80ee2a12.js";import Q from"./KtGratitudeSkeleton.3b86339e.js";import{c2 as F,c as E,c3 as Z,L as D,N as le,Y as re,x as P,R as L,F as j,U as K,e as _,V as r,r as ee,S as k,aH as X,z as Y,y as oe}from"./index.a1748043.js";import{b as ce}from"./index.43b0bc22.js";import{m as w,e as de,b as W,c as pe,d as ue,S as fe,a as ge,N as _e,G as me}from"./grid.65269509.js";function N(n){return n===void 0&&(n=""),`.${n.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function ve(n){let{swiper:e,extendParams:y,on:i,emit:c}=n;const o="swiper-pagination";y({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:t=>t,formatFractionTotal:t=>t,bulletClass:`${o}-bullet`,bulletActiveClass:`${o}-bullet-active`,modifierClass:`${o}-`,currentClass:`${o}-current`,totalClass:`${o}-total`,hiddenClass:`${o}-hidden`,progressbarFillClass:`${o}-progressbar-fill`,progressbarOppositeClass:`${o}-progressbar-opposite`,clickableClass:`${o}-clickable`,lockClass:`${o}-lock`,horizontalClass:`${o}-horizontal`,verticalClass:`${o}-vertical`,paginationDisabledClass:`${o}-disabled`}}),e.pagination={el:null,bullets:[]};let g,d=0;function m(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function S(t,s){const{bulletActiveClass:a}=e.params.pagination;!t||(t=t[`${s==="prev"?"previous":"next"}ElementSibling`],t&&(t.classList.add(`${a}-${s}`),t=t[`${s==="prev"?"previous":"next"}ElementSibling`],t&&t.classList.add(`${a}-${s}-${s}`)))}function x(t,s,a){if(t=t%a,s=s%a,s===t+1)return"next";if(s===t-1)return"previous"}function $(t){const s=t.target.closest(N(e.params.pagination.bulletClass));if(!s)return;t.preventDefault();const a=W(s)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===a)return;const l=x(e.realIndex,a,e.slides.length);l==="next"?e.slideNext():l==="previous"?e.slidePrev():e.slideToLoop(a)}else e.slideTo(a)}function u(){const t=e.rtl,s=e.params.pagination;if(m())return;let a=e.pagination.el;a=w(a);let l,b;const G=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,U=e.params.loop?Math.ceil(G/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(b=e.previousRealIndex||0,l=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex!="undefined"?(l=e.snapIndex,b=e.previousSnapIndex):(b=e.previousIndex||0,l=e.activeIndex||0),s.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){const p=e.pagination.bullets;let O,C,z;if(s.dynamicBullets&&(g=de(p[0],e.isHorizontal()?"width":"height",!0),a.forEach(f=>{f.style[e.isHorizontal()?"width":"height"]=`${g*(s.dynamicMainBullets+4)}px`}),s.dynamicMainBullets>1&&b!==void 0&&(d+=l-(b||0),d>s.dynamicMainBullets-1?d=s.dynamicMainBullets-1:d<0&&(d=0)),O=Math.max(l-d,0),C=O+(Math.min(p.length,s.dynamicMainBullets)-1),z=(C+O)/2),p.forEach(f=>{const v=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(h=>`${s.bulletActiveClass}${h}`)].map(h=>typeof h=="string"&&h.includes(" ")?h.split(" "):h).flat();f.classList.remove(...v)}),a.length>1)p.forEach(f=>{const v=W(f);v===l?f.classList.add(...s.bulletActiveClass.split(" ")):e.isElement&&f.setAttribute("part","bullet"),s.dynamicBullets&&(v>=O&&v<=C&&f.classList.add(...`${s.bulletActiveClass}-main`.split(" ")),v===O&&S(f,"prev"),v===C&&S(f,"next"))});else{const f=p[l];if(f&&f.classList.add(...s.bulletActiveClass.split(" ")),e.isElement&&p.forEach((v,h)=>{v.setAttribute("part",h===l?"bullet-active":"bullet")}),s.dynamicBullets){const v=p[O],h=p[C];for(let A=O;A<=C;A+=1)p[A]&&p[A].classList.add(...`${s.bulletActiveClass}-main`.split(" "));S(v,"prev"),S(h,"next")}}if(s.dynamicBullets){const f=Math.min(p.length,s.dynamicMainBullets+4),v=(g*f-g)/2-z*g,h=t?"right":"left";p.forEach(A=>{A.style[e.isHorizontal()?h:"top"]=`${v}px`})}}a.forEach((p,O)=>{if(s.type==="fraction"&&(p.querySelectorAll(N(s.currentClass)).forEach(C=>{C.textContent=s.formatFractionCurrent(l+1)}),p.querySelectorAll(N(s.totalClass)).forEach(C=>{C.textContent=s.formatFractionTotal(U)})),s.type==="progressbar"){let C;s.progressbarOpposite?C=e.isHorizontal()?"vertical":"horizontal":C=e.isHorizontal()?"horizontal":"vertical";const z=(l+1)/U;let f=1,v=1;C==="horizontal"?f=z:v=z,p.querySelectorAll(N(s.progressbarFillClass)).forEach(h=>{h.style.transform=`translate3d(0,0,0) scaleX(${f}) scaleY(${v})`,h.style.transitionDuration=`${e.params.speed}ms`})}s.type==="custom"&&s.renderCustom?(p.innerHTML=s.renderCustom(e,l+1,U),O===0&&c("paginationRender",p)):(O===0&&c("paginationRender",p),c("paginationUpdate",p)),e.params.watchOverflow&&e.enabled&&p.classList[e.isLocked?"add":"remove"](s.lockClass)})}function B(){const t=e.params.pagination;if(m())return;const s=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length;let a=e.pagination.el;a=w(a);let l="";if(t.type==="bullets"){let b=e.params.loop?Math.ceil(s/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&b>s&&(b=s);for(let G=0;G<b;G+=1)t.renderBullet?l+=t.renderBullet.call(e,G,t.bulletClass):l+=`<${t.bulletElement} ${e.isElement?'part="bullet"':""} class="${t.bulletClass}"></${t.bulletElement}>`}t.type==="fraction"&&(t.renderFraction?l=t.renderFraction.call(e,t.currentClass,t.totalClass):l=`<span class="${t.currentClass}"></span> / <span class="${t.totalClass}"></span>`),t.type==="progressbar"&&(t.renderProgressbar?l=t.renderProgressbar.call(e,t.progressbarFillClass):l=`<span class="${t.progressbarFillClass}"></span>`),e.pagination.bullets=[],a.forEach(b=>{t.type!=="custom"&&(b.innerHTML=l||""),t.type==="bullets"&&e.pagination.bullets.push(...b.querySelectorAll(N(t.bulletClass)))}),t.type!=="custom"&&c("paginationRender",a[0])}function I(){e.params.pagination=pe(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const t=e.params.pagination;if(!t.el)return;let s;typeof t.el=="string"&&e.isElement&&(s=e.el.querySelector(t.el)),!s&&typeof t.el=="string"&&(s=[...document.querySelectorAll(t.el)]),s||(s=t.el),!(!s||s.length===0)&&(e.params.uniqueNavElements&&typeof t.el=="string"&&Array.isArray(s)&&s.length>1&&(s=[...e.el.querySelectorAll(t.el)],s.length>1&&(s=s.filter(a=>ue(a,".swiper")[0]===e.el)[0])),Array.isArray(s)&&s.length===1&&(s=s[0]),Object.assign(e.pagination,{el:s}),s=w(s),s.forEach(a=>{t.type==="bullets"&&t.clickable&&a.classList.add(...(t.clickableClass||"").split(" ")),a.classList.add(t.modifierClass+t.type),a.classList.add(e.isHorizontal()?t.horizontalClass:t.verticalClass),t.type==="bullets"&&t.dynamicBullets&&(a.classList.add(`${t.modifierClass}${t.type}-dynamic`),d=0,t.dynamicMainBullets<1&&(t.dynamicMainBullets=1)),t.type==="progressbar"&&t.progressbarOpposite&&a.classList.add(t.progressbarOppositeClass),t.clickable&&a.addEventListener("click",$),e.enabled||a.classList.add(t.lockClass)}))}function M(){const t=e.params.pagination;if(m())return;let s=e.pagination.el;s&&(s=w(s),s.forEach(a=>{a.classList.remove(t.hiddenClass),a.classList.remove(t.modifierClass+t.type),a.classList.remove(e.isHorizontal()?t.horizontalClass:t.verticalClass),t.clickable&&(a.classList.remove(...(t.clickableClass||"").split(" ")),a.removeEventListener("click",$))})),e.pagination.bullets&&e.pagination.bullets.forEach(a=>a.classList.remove(...t.bulletActiveClass.split(" ")))}i("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;const t=e.params.pagination;let{el:s}=e.pagination;s=w(s),s.forEach(a=>{a.classList.remove(t.horizontalClass,t.verticalClass),a.classList.add(e.isHorizontal()?t.horizontalClass:t.verticalClass)})}),i("init",()=>{e.params.pagination.enabled===!1?T():(I(),B(),u())}),i("activeIndexChange",()=>{typeof e.snapIndex=="undefined"&&u()}),i("snapIndexChange",()=>{u()}),i("snapGridLengthChange",()=>{B(),u()}),i("destroy",()=>{M()}),i("enable disable",()=>{let{el:t}=e.pagination;t&&(t=w(t),t.forEach(s=>s.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),i("lock unlock",()=>{u()}),i("click",(t,s)=>{const a=s.target,l=w(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&l&&l.length>0&&!a.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&a===e.navigation.nextEl||e.navigation.prevEl&&a===e.navigation.prevEl))return;const b=l[0].classList.contains(e.params.pagination.hiddenClass);c(b===!0?"paginationShow":"paginationHide"),l.forEach(G=>G.classList.toggle(e.params.pagination.hiddenClass))}});const H=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:t}=e.pagination;t&&(t=w(t),t.forEach(s=>s.classList.remove(e.params.pagination.paginationDisabledClass))),I(),B(),u()},T=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:t}=e.pagination;t&&(t=w(t),t.forEach(s=>s.classList.add(e.params.pagination.paginationDisabledClass))),M()};Object.assign(e.pagination,{enable:H,disable:T,render:B,update:u,init:I,destroy:M})}function he(){const n=F();return{gratitudes:E(()=>n.BADGES.map(i=>{var g,d,m;const c=Z.find(S=>S.CODE===i.CODE),o=(m=(d=((g=n.BADGES_COUNTERS)!=null?g:{})[i.ID])==null?void 0:d.COUNT)!=null?m:0;return typeof c=="undefined"?Object.assign({},i):Object.assign({},i,c,{COUNT:o,ICON_COLOR:o>0?c.ICON_COLOR:"app-grey-9"})}).sort((i,c)=>Number(i.SORT)-Number(c.SORT))),openGratitudePage:i=>{const c=window.BX,{width:o}=ce(),g=typeof i!="undefined"?n.URLS.LIST+`&gratCode=${i}`:n.URLS.ADD,d=new URLSearchParams(g).get("gratUserId"),m=typeof i!="undefined"?{width:1e3}:{cacheable:!1,data:{entityType:"gratPost",entityId:d},width:1e3};o.value>768?c.SidePanel.Instance.open(g,m):window.location.href=g}}}const ye={class:"kt-gratitude-list"},be=D({__name:"KtGratitudeList",setup(n){const{IS_OWN_PROFILE:e}=le(re()),{gratitudes:y,openGratitudePage:i}=he();function c(o){e.value||i(o)}return(o,g)=>(P(),L("ul",ye,[(P(!0),L(j,null,K(r(y),d=>(P(),L("li",{key:d.CODE,class:"kt-gratitude-list__item"},[_(r(J),{icon:d.ICON,"is-active":d.COUNT>0,count:d.COUNT,color:d.ICON_COLOR,"is-clickable":!r(e),name:d.NAME,"show-count":"","show-name":"",onClick:m=>c(d.CODE)},null,8,["icon","is-active","count","color","is-clickable","name","onClick"])]))),128))]))}});var qe=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"}));const Ce={class:"kt-gratitude-list-skeleton"},ke=D({__name:"KtGratitudeListSkeleton",setup(n){return(e,y)=>(P(),L("div",Ce,[(P(),L(j,null,K(14,i=>_(r(Q),{key:i})),64))]))}});var Ve=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));function te(){const n=F(),e=ee(!1),y=E(()=>{var S;const m=(S=n.POSTS)!=null?S:Object.create(null);return Object.keys(m).map(x=>{const $=m[x],u=n.USERS[$.AUTHOR_ID];let B=null,I=-1;for(;++I<n.BADGES.length;){const M=n.BADGES[I],H=Number($.BADGE_ID),T=Number(M.ID);if(H===T){B=Z.find(t=>t.CODE===M.CODE);break}}return typeof B=="undefined"?Object.assign({SENDER:u},$):Object.assign({SENDER:u},$,B)})}),i=E(()=>n.NAV.pageSize*n.NAV.currentPage<n.NAV.recordCount),c=E(()=>n.NAV.currentPage>1);return{gratitudePosts:y,canLoadMorePosts:i,canLoadPreviousPosts:c,gratitudePostsLoading:e,openGratitudePostPage:m=>{const S=window.BX,x={width:1e3};S.SidePanel.Instance.open(m,x)},loadMorePosts:async()=>{try{e.value=!0,await n.loadMorePosts()}finally{e.value=!1}},loadPreviousPosts:async()=>{try{e.value=!0,await n.loadPreviousPosts()}finally{e.value=!1}}}}const Se={class:"kt-gratitude-post"},Pe={class:"kt-gratitude-post__left"},$e={class:"kt-gratitude-post__right"},Le={class:"kt-gratitude-post__content"},Oe={class:"kt-gratitude-post__time"},se=D({__name:"KtGratitudePost",props:{title:{},url:{},datetime:{},sender:{},icon:{},iconColor:{}},setup(n){const e=n,{openGratitudePostPage:y}=te();return(i,c)=>(P(),L("div",Se,[k("div",Pe,[_(r(ie),{user:e.sender,"show-avatar":"",size:"md",class:"kt-gratitude-post__user"},null,8,["user"]),_(r(J),{icon:e.icon,color:e.iconColor,"is-active":"",class:"kt-gratitude-post__gratitude"},null,8,["icon","color"])]),k("div",$e,[k("div",Le,[k("a",{class:"kt-gratitude-post__title",onClick:c[0]||(c[0]=o=>r(y)(e.url))},[_(r(q),{content:e.title,lines:1},null,8,["content"])]),k("div",Oe,[_(r(q),{content:e.datetime,lines:1},null,8,["content"])])])])]))}});var Xe=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));const xe={class:"kt-gratitude-post-skeleton"},we={class:"kt-gratitude-post-skeleton__left"},Be={class:"kt-gratitude-post-skeleton__right"},Ge={class:"kt-gratitude-post-skeleton__content"},ae=D({__name:"KtGratitudePostSkeleton",setup(n){return(e,y)=>(P(),L("div",xe,[k("div",we,[_(r(ne),{"show-avatar":"",size:"md"}),_(r(Q),{class:"kt-gratitude-post-skeleton__gratitude"})]),k("div",Be,[k("div",Ge,[_(r(R),{type:"text",width:"100%",height:"14px",class:"q-mb-xs"}),_(r(R),{type:"text",width:"50%",height:"14px"})])])]))}});var Ye=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));const Ie={class:"kt-gratitude-post-slider-wr"},Me={class:"kt-gratitude-post-slider__nav"},Ae={class:"kt-gratitude-post-slider__content"},De=D({__name:"KtGratitudePostSlider",setup(n){const e=[_e,ve,me],y=X(),i=X(),c=F(),{gratitudePosts:o,canLoadMorePosts:g}=te(),d=ee(0);m();function m(){g.value&&c.loadMorePosts()}function S(x){const u=Math.ceil(x.slides.length/3);d.value=x.activeIndex,d.value>=u-2&&g.value&&c.loadMorePosts()}return(x,$)=>(P(),L("div",Ie,[k("div",Me,[_(r(V),{theme:"tertiary","data-btn-prev":r(i),icon:"chevron-left",round:"",dense:"",class:"kt-gratitude-post-slider__btn"},null,8,["data-btn-prev"]),_(r(V),{theme:"tertiary","data-btn-next":r(y),icon:"chevron-right",round:"",dense:"",class:"kt-gratitude-post-slider__btn"},null,8,["data-btn-next"])]),k("div",Ae,[_(r(ge),{"slides-per-view":1,"space-between":16,modules:e,grid:{rows:3,fill:"column"},navigation:{prevEl:`[data-btn-prev='${r(i)}']`,nextEl:`[data-btn-next='${r(y)}']`},pagination:{clickable:!0,dynamicBullets:!0,dynamicMainBullets:3,el:".kt-gratitude-post-slider__pagination"},class:"kt-gratitude-post-slider",onSlideChange:S},{default:Y(()=>[(P(!0),L(j,null,K(r(o),u=>(P(),oe(r(fe),{key:u.ID},{default:Y(()=>[_(r(se),{title:u.TITLE,url:u.URL,datetime:u.DATE_PUBLISH,icon:u.ICON,"icon-color":u.ICON_COLOR,sender:u.SENDER},null,8,["title","url","datetime","icon","icon-color","sender"])]),_:2},1024))),128))]),_:1},8,["navigation"])]),$[0]||($[0]=k("footer",{class:"kt-gratitude-post-slider__footer"},[k("div",{class:"kt-gratitude-post-slider__pagination"})],-1))]))}});var We=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));const ze={class:"kt-gratitude-post-slider-skeleton-wr"},Ne={class:"kt-gratitude-post-slider-skeleton__nav"},Te={class:"kt-gratitude-post-slider-skeleton__content"},Ee=D({__name:"KtGratitudePostSliderSkeleton",setup(n){return(e,y)=>(P(),L("div",ze,[k("div",Ne,[_(r(R),{type:"circle",size:"32px",class:"kt-gratitude-post-slider-skeleton__btn"}),_(r(R),{type:"circle",size:"32px",class:"kt-gratitude-post-slider-skeleton__btn"})]),k("div",Te,[(P(),L(j,null,K(3,i=>_(r(ae),{key:i})),64))])]))}});var Je=Object.freeze(Object.defineProperty({__proto__:null,default:Ee},Symbol.toStringTag,{value:"Module"}));export{qe as K,ve as P,be as _,De as a,ke as b,Ee as c,Ve as d,Xe as e,Ye as f,We as g,Je as h,he as u};
