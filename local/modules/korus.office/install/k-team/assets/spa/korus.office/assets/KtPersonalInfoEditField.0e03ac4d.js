import{_ as N}from"./KtWidgetLayoutRow.7ad5d39d.js";import{L as g,x as c,y as _,aB as F,z as E,e as I,V as m,c as L,Q as ue,ac as ne,al as R,S as A,a0 as se,av as re,ad as w,w as C,R as M,$ as ie,F as O,U as K,r as T,o as me,B as de,e2 as pe,aE as ce,aF as fe,aL as _e,e1 as U,K as z,ag as P,W as ye}from"./index.a1748043.js";import{_ as h}from"./KtSelect.f51478e4.js";import{Q as ve}from"./QDate.59abae0b.js";import{Q as Ee}from"./QPopupProxy.64a89f3e.js";import{C as Ie}from"./ClosePopup.034ffd88.js";import{_ as Y}from"./KtButton.5c4817ba.js";import{a as ge}from"./QSelect.1740ff4d.js";import"./KtWidgetLayoutText.4eb60d33.js";import"./use-render-cache.3aae9b27.js";import"./QMenu.8a4718ad.js";import"./QBtnDropdown.41a9457c.js";import"./colors.85fc653d.js";import"./QChip.2708c0c7.js";import"./QItemLabel.b302d2e1.js";import"./rtl.276c3f1b.js";const G=g({__name:"KtInput",props:{type:{},modelValue:{},rules:{},lazyRules:{type:Boolean},autogrow:{type:Boolean},errorMessage:{}},emits:["update:modelValue"],setup(a,{emit:n}){const l=a,o=n,r=p=>{o("update:modelValue",p)};return(p,u)=>(c(),_(F,{"model-value":l.modelValue,rules:l.rules,"lazy-rules":l.lazyRules,type:l.type,autogrow:l.autogrow,outlined:"",class:"kt-input","onUpdate:modelValue":r},null,8,["model-value","rules","lazy-rules","type","autogrow"]))}}),$=g({__name:"KtPersonalInfoEditText",props:{label:{},type:{default:"text"},modelValue:{},rules:{},lazyRules:{type:Boolean},errorMessage:{}},emits:["update:modelValue"],setup(a){const n=a;return(l,o)=>(c(),_(m(N),{label:n.label},{default:E(()=>[I(m(G),{"model-value":n.modelValue,rules:n.rules,"lazy-rules":n.lazyRules,type:n.type,"onUpdate:modelValue":o[0]||(o[0]=r=>l.$emit("update:modelValue",r))},null,8,["model-value","rules","lazy-rules","type"])]),_:1},8,["label"]))}});const Ve=g({__name:"KtCheckbox",props:{modelValue:{type:Boolean},theme:{default:"dark"}},emits:["update:modelValue"],setup(a){const n=a,l=L(()=>[`kt-checkbox--theme-${n.theme}`]);return(o,r)=>(c(),_(ne,{"model-value":n.modelValue,"onUpdate:modelValue":r[0]||(r[0]=p=>o.$emit("update:modelValue",p)),class:ue(["kt-checkbox",l.value])},null,8,["model-value","class"]))}}),Se=g({__name:"KtPersonalInfoEditCheckbox",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(a){const n=a;return(l,o)=>(c(),_(m(N),{label:n.label},{default:E(()=>[I(m(Ve),{"model-value":n.modelValue,"onUpdate:modelValue":o[0]||(o[0]=r=>l.$emit("update:modelValue",r))},null,8,["model-value"])]),_:1},8,["label"]))}});const be=g({__name:"KtPersonalInfoEditSelect",props:{label:{},modelValue:{},options:{},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(a){const n=a;return(l,o)=>(c(),_(m(N),{label:n.label},{default:E(()=>[I(m(h),{"model-value":n.modelValue,options:n.options,multiple:n.multiple,"onUpdate:modelValue":o[0]||(o[0]=r=>l.$emit("update:modelValue",r))},null,8,["model-value","options","multiple"])]),_:1},8,["label"]))}});const Ae={class:"row items-center justify-end"},Ne=g({__name:"KtDatepicker",props:{modelValue:{}},emits:["update:modelValue"],setup(a){const n=a;return(l,o)=>(c(),_(F,{"model-value":n.modelValue,outlined:"","onUpdate:modelValue":o[1]||(o[1]=r=>l.$emit("update:modelValue",r)),class:"kt-datepicker"},{append:E(()=>[I(R,{name:"event",class:"cursor-pointer"},{default:E(()=>[I(Ee,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:E(()=>[I(ve,{"model-value":n.modelValue,mask:"DD.MM.YYYY","onUpdate:modelValue":o[0]||(o[0]=r=>l.$emit("update:modelValue",r))},{default:E(()=>[A("div",Ae,[se((c(),_(m(Y),{theme:"primary"},{default:E(()=>[re(w(l.$t("datepicker.closePopup")),1)]),_:1})),[[Ie]])])]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),x=g({__name:"KtPersonalInfoEditDatetime",props:{label:{},modelValue:{}},emits:["update:modelValue"],setup(a){const n=a;return(l,o)=>(c(),_(m(N),{label:n.label},{default:E(()=>[I(m(Ne),{"model-value":n.modelValue,"onUpdate:modelValue":o[0]||(o[0]=r=>l.$emit("update:modelValue",r))},null,8,["model-value"])]),_:1},8,["label"]))}}),ze={class:"row items-center q-col-gutter-md"},De={class:"col-sm-6 col-xs-12"},Te={key:0,class:"col-6"},Me=g({__name:"KtPersonalInfoEditTimezone",props:{label:{},timezone:{},timezoneAuto:{},timezoneItems:{},timezoneItemsAuto:{}},emits:["update:timezoneAuto","update:timezone"],setup(a,{emit:n}){const l=a,o=n,r=L(()=>{var p;return((p=l.timezoneAuto)==null?void 0:p.VALUE)==="N"});return C(r,()=>{r.value||o("update:timezone",null)}),(p,u)=>(c(),_(m(N),{label:l.label,class:"timezone"},{default:E(()=>[A("div",ze,[A("div",De,[I(m(h),{"model-value":l.timezoneAuto,options:l.timezoneItemsAuto,"onUpdate:modelValue":u[0]||(u[0]=y=>p.$emit("update:timezoneAuto",y))},null,8,["model-value","options"])]),r.value?(c(),M("div",Te,[I(m(h),{"model-value":l.timezone,options:l.timezoneItems,"onUpdate:modelValue":u[1]||(u[1]=y=>p.$emit("update:timezone",y))},null,8,["model-value","options"])])):ie("",!0)])]),_:1},8,["label"]))}});const Ue={class:"kt-messenger-list q-mt-md"},ke={class:"kt-messenger-item__label"},Ce=g({__name:"KtPersonalInfoEditMessengers",props:{label:{},modelValue:{},options:{}},emits:["update:modelValue"],setup(a,{emit:n}){const l=a,o=n,r=i=>(l.modelValue.length>i.length?l.modelValue.forEach(t=>{i.includes(t)||(t[t.NAME]="")}):i.forEach(t=>(t[t.NAME]||(t[t.NAME]=""),t)),i),p=(i,t)=>l.modelValue.map(e=>(e.NAME===i&&(e[e.NAME]=t),e)),u=i=>{const t=l.modelValue.filter(e=>e!==i);o("update:modelValue",t)},y=(i,t)=>{const e=Array.isArray(t)?r(t):p(i,t);o("update:modelValue",e)};return(i,t)=>(c(),_(m(N),{label:l.label},{default:E(()=>[I(m(h),{"model-value":l.modelValue,options:l.options,multiple:"","onUpdate:modelValue":t[0]||(t[0]=e=>y(null,e))},null,8,["model-value","options"]),A("ul",Ue,[(c(!0),M(O,null,K(l.modelValue,e=>(c(),M("li",{key:e.NAME,class:"kt-messenger-item"},[A("span",ke,w(e.NAME)+":",1),I(m(G),{"model-value":e[e.NAME],"onUpdate:modelValue":s=>y(e.NAME,s)},null,8,["model-value","onUpdate:modelValue"]),I(m(Y),{round:"",icon:"kt:close",class:"kt-messenger-item__remove-btn q-ml-md",onClick:s=>u(e)},null,8,["onClick"])]))),128))])]),_:1},8,["label"]))}}),he=g({__name:"KtPersonalInfoEditWorkplace",props:{label:{},type:{default:"text"},modelValue:{},rules:{},lazyRules:{type:Boolean},errorMessage:{}},emits:["update:modelValue"],setup(a){const n=a;return(l,o)=>(c(),_(m(N),{label:n.label},{default:E(()=>o[0]||(o[0]=[A("i",{class:"text-app-grey-5"},"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0442\u043E\u043B\u044C\u043A\u043E \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u043E\u043C \u043F\u043E\u0440\u0442\u0430\u043B\u0430.",-1)])),_:1},8,["label"]))}});const Be=g({__name:"KtSelector",props:{label:{},outlined:{type:Boolean,default:!0},modelValue:{},entities:{},id:{},loading:{type:Boolean},readonly:{type:Boolean},showFooter:{type:Boolean,default:!1},rules:{},lazyRules:{type:Boolean},preselectedItems:{},preload:{type:Boolean},multiple:{type:Boolean,default:!1},dropdownMode:{type:Boolean,default:!1},enableSearch:{type:Boolean,default:!0},autoHide:{type:Boolean,default:!0},hideByEsc:{type:Boolean,default:!1},hideOnSelect:{type:Boolean,default:!0},hideOnDeselect:{type:Boolean,default:!1},targetElement:{default:"field"},showIcon:{type:Boolean,default:!0},dense:{type:Boolean,default:!1}},emits:["update:modelValue","select:item","show","hide","onDeselect:item"],setup(a,{emit:n}){const l=a,o=n,r=window.BX,p=T(!0),u=T(!1),y=T([]),i=T(null);let t=null;me(Q),de(ae),C(()=>l.preselectedItems,e),C(()=>l.loading,s),C(()=>l.targetElement,S);function e(){t.loadState==="DONE"&&te(),t.setPreselectedItems(l.preselectedItems),t.loadState==="UNSENT"?(p.value=!0,u.value=!0,t.load()):t.loadState==="DONE"&&(X(),V(),y.value=t.getSelectedItems())}function s(){p.value=!!l.loading}function S(){const v=t.getPopup(),f=B();v.setBindElement(f)}function V(){var D;const v=t.getSelectedItems(),f=l.multiple?v.map(oe=>oe.id):(D=v[0])==null?void 0:D.id;o("update:modelValue",f)}function d(){l.readonly||(le(),t.show())}function Q(){t=new r.UI.EntitySelector.Dialog(H()),pe(l.preselectedItems)&&(p.value=!1)}function H(){const v=!l.multiple,f={targetNode:B(),enableSearch:l.enableSearch,entities:l.entities,multiple:l.multiple,preload:l.preload,dropdownMode:l.dropdownMode,autoHide:l.autoHide,hideByEsc:l.hideByEsc,hideOnSelect:v,hideOnDeselect:l.hideOnDeselect,preselectedItems:l.preselectedItems,events:{onLoad:q,"Item:onSelect":W,"Item:onDeselect":j,"Item:onBeforeSelect":Z,onShow:J,onHide:ee}};return l.showFooter||(f.footer=void 0),f}function Z(v){const f=v.data.item.customData.get("cantSelect");f&&f.value===!0&&(v.preventDefault(),ce.create({type:"negative",message:f.message,position:"top"}))}function q(){u.value&&(V(),u.value=!1),p.value=!1,y.value=t.getSelectedItems(),l.showFooter||t.setFooter(null)}function W(v){const{item:f}=v.getData();V(),y.value=t.getSelectedItems(),o("select:item",f)}function X(){t.getPreselectedItems().forEach(v=>{const f=t.getItem(v);f&&f.select(!0)})}function j(){V(),y.value=t.getSelectedItems(),o("onDeselect:item")}function J(){o("show")}function ee(){o("hide")}function te(){t.deselectAll()}function le(){const f=B()==null?parseFloat(document.body.style.top)*-1:0;t.setOffsetTop(f)}function B(){if(l.targetElement==="field")return i.value}function ae(){t.destroy()}return(v,f)=>(c(),_(m(N),{label:l.label},{default:E(()=>[I(ge,{"model-value":l.modelValue,outlined:l.outlined,rules:l.rules,"lazy-rules":l.lazyRules,loading:p.value,readonly:l.readonly,dense:l.dense,class:"kt-selector"},fe({control:E(()=>[A("button",{class:"kt-selector__trigger self-center full-width no-outline",tabindex:"0",type:"button",ref_key:"selectorTriggerEl",ref:i,onClick:d},null,512),A("div",{onClick:d},[(c(!0),M(O,null,K(y.value,D=>(c(),M("div",{key:D.id},w(l.modelValue?D.title:"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E"),1))),128))])]),_:2},[l.showIcon?{name:"append",fn:E(()=>[I(R,{name:"expand_more",color:"cursor-pointer",onClick:d})]),key:"0"}:void 0]),1032,["model-value","outlined","rules","lazy-rules","loading","readonly","dense"])]),_:1},8,["label"]))}}),k={isMessenger(a){return a.name==="UF_MESSENGERS"&&Array.isArray(a.data.fieldInfo.SETTINGS)},isCheckbox(a){return a.data.fieldInfo.USER_TYPE_ID==="boolean"&&!Array.isArray(a.data.fieldInfo.SETTINGS)&&a.data.fieldInfo.SETTINGS.DISPLAY==="CHECKBOX"},isDate(a){return a.data.fieldInfo.USER_TYPE_ID==="date"},isEmployee(a){return a.data.fieldInfo.USER_TYPE_ID==="employee"||a.data.fieldInfo.USER_TYPE_ID==="user"}},b=(a,n)=>{const l=n.find(o=>String(o.VALUE)===String(a));return typeof l=="undefined"?"":l.NAME};function we(){const a=_e(),n=["email"],l=[t=>t&&t.length>3||"\u041F\u043E\u043B\u0435 `Login` \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u043D\u0435 \u043C\u0435\u043D\u044C\u0448\u0435 3-\u0445 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432!"],o=t=>{let e=a.$state[t.name],s,S="text",V;switch(t.type){case"datetime":return s=e&&!Number.isNaN(new Date(e))?U(new Date(e)):null,{value:e&&!Number.isNaN(new Date(e))?U(new Date(e)):null,valueInitial:s,[Symbol.toStringTag]:"datetime"};case"list":return s={VALUE:e,NAME:b(e,t.data.items)},{value:{VALUE:e,NAME:b(e,t.data.items)},valueInitial:s,[Symbol.toStringTag]:"list"};case"multilist":return s=e.map(d=>({VALUE:d,NAME:b(d,t.data.items)})),{value:e.map(d=>({VALUE:d,NAME:b(d,t.data.items)})),valueInitial:s,[Symbol.toStringTag]:"multilist"};case"timezone":return s={timezoneValue:{VALUE:e,NAME:b(e,t.data.timezone_items)},timezoneValueAuto:{VALUE:a.$state.AUTO_TIME_ZONE,NAME:b(a.$state.AUTO_TIME_ZONE,t.data.auto_timezone_items)}},{value:{timezoneValue:{VALUE:e,NAME:b(e,t.data.timezone_items)},timezoneValueAuto:{VALUE:a.$state.AUTO_TIME_ZONE,NAME:b(a.$state.AUTO_TIME_ZONE,t.data.auto_timezone_items)}},valueInitial:s,[Symbol.toStringTag]:"timezone"};case"userField":return V=t.data.fieldInfo.USER_TYPE_ID,S="text",V==="integer"?(e=typeof e=="number"?e:null,s=typeof e=="number"?e:null):V==="boolean"?(e=Boolean(e),s=Boolean(e)):V==="date"?(e=e&&!Number.isNaN(new Date(e))?U(new Date(e)):null,s=e&&!Number.isNaN(new Date(e))?U(new Date(e)):null,S="datetime"):V==="employee"?t.data.fieldInfo.MULTIPLE==="Y"?(e=e?e.map(d=>d.ID):[],s=e?e.map(d=>d.ID):[]):(e=e?e.ID:null,s=e?e.ID:null):V==="messengers"?(e=e?e.map(d=>({VALUE:d.value,NAME:d.messenger,[d.messenger]:d.value})):[],s=e?e.map(d=>({VALUE:d.value,NAME:d.messenger,[d.messenger]:d.value})):[],S="messengers"):(e=typeof e=="string"?e:"",s=typeof e=="string"?e:""),{value:e,valueInitial:s,[Symbol.toStringTag]:S};default:return s=e!=null?e:"",{value:e!=null?e:"",valueInitial:s,[Symbol.toStringTag]:S}}},r=t=>{let e=a.$state[t.name],s;switch(t.type){case"userField":return s=t.data.fieldInfo.USER_TYPE_ID,s==="employee"?t.data.fieldInfo.MULTIPLE==="Y"?e=e?e.map(S=>["user",S.ID]):[["user",""]]:e=e?[["user",e.ID]]:[["user",""]]:e=typeof e=="string"?e:"",{preselectedValue:e};default:return{preselectedValue:e!=null?e:""}}},p=t=>{switch(t.type){case"list":case"multilist":return z(be);case"datetime":return z(x);case"userField":return k.isMessenger(t)?z(Ce):k.isCheckbox(t)?z(Se):k.isDate(t)?z(x):z($);default:return z($)}},u=t=>{if(t.type!=="userField")return`is-${t.type}-field`;switch(t.data.fieldInfo.USER_TYPE_ID){case"boolean":return"is-checkbox-field";case"date":return"is-datetime-field";default:return"is-text-field"}},y=t=>{const e=Object.create(null);switch(e.label=t.title,t.type){case"text":case"link":case"datetime":case"phone":t.name==="LOGIN"?(e.rules=l,e.lazyRules=!0):t.name==="EMAIL"&&(e.rules=n,e.lazyRules=!0,e.errorMessage="\u041F\u043E\u043B\u0435 `Email` \u0443\u043A\u0430\u0437\u0430\u043D\u043E \u0432 \u043D\u0435\u0432\u0435\u0440\u043D\u043E\u043C \u0444\u043E\u0440\u043C\u0430\u0442\u0435!");break;case"list":case"multilist":e.options=t.data.items,e.multiple=t.type==="multilist";break;case"userField":t.name==="UF_MESSENGERS"&&Array.isArray(t.data.fieldInfo.SETTINGS)&&(e.options=t.data.fieldInfo.SETTINGS.map(s=>({NAME:s.code,VALUE:s.value})),e.multiple=!0),t.data.fieldInfo.USER_TYPE_ID==="integer"&&(e.type="number"),t.data.fieldInfo.USER_TYPE_ID==="boolean"&&(e.yAligment="center");break}return e},i=k.isEmployee;return{getComponentValue:o,getComponentPreselectedValue:r,getComponentName:p,getComponentClassName:u,getComponentProps:y,isEmployeeField:i}}const je=g({__name:"KtPersonalInfoEditField",props:{field:{}},setup(a){const{getComponentName:n,getComponentClassName:l,getComponentProps:o,isEmployeeField:r}=we(),u=T(a.field);return(y,i)=>u.value.type==="timezone"?(c(),_(m(Me),{key:0,label:u.value.title,"timezone-items":u.value.data.timezone_items,"timezone-items-auto":u.value.data.auto_timezone_items,timezone:u.value.value.timezoneValue,"onUpdate:timezone":i[0]||(i[0]=t=>u.value.value.timezoneValue=t),timezoneAuto:u.value.value.timezoneValueAuto,"onUpdate:timezoneAuto":i[1]||(i[1]=t=>u.value.value.timezoneValueAuto=t)},null,8,["label","timezone-items","timezone-items-auto","timezone","timezoneAuto"])):u.value.type==="userField"&&m(r)(u.value)?(c(),_(m(Be),{key:1,label:u.value.title,modelValue:u.value.value,"onUpdate:modelValue":i[2]||(i[2]=t=>u.value.value=t),entities:[{id:"user"}],"preselected-items":u.value.preselectedValue,multiple:u.value.data.fieldInfo.MULTIPLE==="Y","target-element":null,dense:!0,"lazy-rules":""},null,8,["label","modelValue","preselected-items","multiple"])):u.value.name==="UF_WORKPLACE"?(c(),_(m(he),P({key:2,class:m(l)(u.value)},m(o)(u.value),{modelValue:u.value.value,"onUpdate:modelValue":i[3]||(i[3]=t=>u.value.value=t)}),null,16,["class","modelValue"])):(c(),_(ye(m(n)(u.value)),P({key:3,class:m(l)(u.value)},m(o)(u.value),{modelValue:u.value.value,"onUpdate:modelValue":i[4]||(i[4]=t=>u.value.value=t)}),null,16,["class","modelValue"]))}});export{je as default};
