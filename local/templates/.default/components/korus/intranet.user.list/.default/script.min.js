!function(){var e=BX.namespace("BX.Intranet.UserList");e.Manager||(e.Manager=function(t){this.init(t)},e.Manager.prototype={init:function(t){this.componentName=t.componentName,this.signedParameters=t.signedParameters,this.gridId=t.gridId,this.filterId=BX.type.isNotEmptyString(t.filterId)?t.filterId:null,this.gridContainer=BX.type.isNotEmptyString(t.gridContainerId)?BX(t.gridContainerId):null,this.invitationLink=t.invitationLink,t.toolbar.componentName=this.componentName,this.toolbarInstance=new e.Toolbar(t.toolbar),this.bindTags(),BX.addCustomEvent("SidePanel.Slider:onMessage",function(t){"userProfileSlider::reloadList"==t.getEventId()&&BX.Main.gridManager.reload(this.gridId)}.bind(this))},showInvitation:function(){BX.SidePanel.Instance.open(this.invitationLink,{cacheable:!1,allowChangeHistory:!1})},addTask:function(t){BX.SidePanel.Instance.open("/company/personal/user/"+t+"/tasks/task/edit/0/?RESPONSIBLE_ID="+t+"&ta_sec=user&ta_el=context_menu")},sendMessage:function(t){BX.type.isNotEmptyObject(BXIM)&&BXIM.openMessenger(t)},viewMessageHistory:function(t){BX.type.isNotEmptyObject(BXIM)&&BXIM.openHistory(t)},reinvite:function(t,e,n){BX.ajax.runAction("intranet.controller.invite.reinvite",{data:{params:{userId:t,extranet:e?"Y":"N"}}}).then(function(t){t.data.result&&BX.PopupWindowManager.create("invite_access"+Math.floor(1e3*Math.random()),n,{content:"<p>"+BX.message("INTRANET_USER_LIST_ACTION_REINVITE_SUCCESS")+"</p>",offsetLeft:-10,offsetTop:7,autoHide:!0}).show()}.bind(this),function(t){}.bind(this))},activityAction:function(e,n){this.confirmUser(e)&&BX.ajax.runComponentAction(this.componentName,"setActivity",{mode:"class",signedParameters:this.signedParameters,data:{params:{userId:n,action:e}}}).then(function(t){BX.Main.gridManager.reload(this.gridId)}.bind(this),function(t){BX.type.isNotEmptyObject(t)&&BX.type.isArray(t.errors)&&("delete"===e?this.activityAction("deactivateInvited",n):BX.PopupWindowManager.create("delete_error"+Math.floor(1e3*Math.random()),null,{content:t.errors[0].message,offsetLeft:-10,offsetTop:7,autoHide:!0}).show())}.bind(this))},confirmUser:function(t){var e="",e="restore"==t?BX.message("INTRANET_USER_LIST_ACTION_RESTORE_CONFIRM"):"delete"==t?BX.message("INTRANET_USER_LIST_ACTION_DELETE_CONFIRM"):"deactivateInvited"==t?BX.message("INTRANET_USER_LIST_ACTION_DEACTIVATE_INVITED_CONFIRM"):BX.message("INTRANET_USER_LIST_ACTION_DEACTIVATE_CONFIRM");return confirm(e)},bindTags:function(){var t;BX.type.isDomNode(this.gridContainer)&&(BX.type.isNotEmptyString(this.filterId)&&BX.type.isNotEmptyObject(BX.Main)&&BX.type.isNotEmptyObject(BX.Main.filterManager)&&(t=BX.Main.filterManager.getById(this.filterId))&&(this.filterApi=t.getApi()),this.gridContainer.addEventListener("click",BX.delegate(function(t){var e=BX.getEventTarget(t).getAttribute("bx-tag-value");BX.type.isNotEmptyString(e)&&this.clickTag(e)&&t.preventDefault()},this),!0))},clickTag:function(t){var e=!1;return BX.type.isNotEmptyString(t)&&BX.type.isNotEmptyObject(this.filterApi)&&(this.filterApi.setFields({TAGS:t}),this.filterApi.apply(),t=BX.GetWindowScrollPos(),new BX.easing({duration:500,start:{scroll:t.scrollTop},finish:{scroll:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function(t){window.scrollTo(0,t.scroll)},complete:function(){}}).animate(),e=!0),e}},e.Toolbar=function(t){this.id="",this.menuItems=null,this.menuId=null,this.menu=null,this.menuOpened=!1,this.menuPopup=null,this.componentName=null,this.initialize(t)},e.Toolbar.prototype={initialize:function(t){this.id=t.id,this.menuItems=t.menuItems,this.componentName=t.componentName,BX.type.isNotEmptyString(t.menuButtonId)&&BX(t.menuButtonId)&&BX.bind(BX(t.menuButtonId),"click",function(t){this.menuButtonClick(t.currentTarget)}.bind(this))},getId:function(){return this._id},getSetting:function(t,e){return this._settings.getParam(t,e)},_onMenuClose:function(){var t={menu:this._menu};BX.onCustomEvent(window,"CrmInterfaceToolbarMenuClose",[this,t])},menuButtonClick:function(t){this.openMenu(t)},openMenu:function(t){if(this.menuOpened)this.closeMenu();else if(BX.type.isArray(this.menuItems)){for(var e=[],n="",i=0;i<this.menuItems.length;i++){var o=this.menuItems[i];void 0!==o.SEPARATOR&&o.SEPARATOR?e.push({SEPARATOR:!0}):BX.type.isNotEmptyString(o.TYPE)&&(BX.type.isNotEmptyString(o.LINK)&&(n='window.location.href = "'+o.LINK+'"; return false;'),e.push({text:BX.type.isNotEmptyString(o.TITLE)?o.TITLE:"",onclick:n}))}this.menuId=this.id.toLowerCase()+"_menu",BX.PopupMenu.show(this.menuId,t,e,{autoHide:!0,closeByEsc:!0,offsetTop:0,offsetLeft:0,events:{onPopupShow:BX.delegate(this.onPopupShow,this),onPopupClose:BX.delegate(this.onPopupClose,this),onPopupDestroy:BX.delegate(this.onPopupDestroy,this)}}),this.menuPopup=BX.PopupMenu.currentItem}},closeMenu:function(){this.menuPopup&&this.menuPopup.popupWindow&&this.menuPopup.popupWindow.destroy()},onPopupShow:function(){this.menuOpened=!0},onPopupClose:function(){this.closeMenu()},onPopupDestroy:function(){this.menuOpened=!1,this.menuPopup=null,void 0!==BX.PopupMenu.Data[this.menuId]&&delete BX.PopupMenu.Data[this.menuId]}},document.querySelectorAll(".main-grid-cell-content > a").forEach(function(t){t.className||(t.className="ui-link ui-link-dark")}),document.querySelectorAll(".main-grid-cell-content > .field-wrap > .field-item > .uf-employee-wrap").forEach(function(t){t.classList.add("ui-link","ui-link-dark")}))}();